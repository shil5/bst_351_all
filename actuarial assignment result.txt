> # SHILPA 2017IMSST008 
> #Table 5.3 Actuarial estimate(life table)
> Nt<-c(200,195,184,167,157,147,126,114,105,101)
> Dt<-c(5,10,12,8,10,15,9,8,4,3)
> Ct<-c(0,1,5,2,0,6,3,1,0,1) 
> length(Nt)
[1] 10
> ini<-data.frame(Nt,Dt,Ct);ini #Initial Table
    Nt Dt Ct
1  200  5  0
2  195 10  1
3  184 12  5
4  167  8  2
5  157 10  0
6  147 15  6
7  126  9  3
8  114  8  1
9  105  4  0
10 101  3  1
> Ntstar<-(Nt-(Ct/2));Ntstar #average
 [1] 200.0 194.5 181.5 166.0 157.0 144.0 124.5 113.5 105.0 100.5
> 
> q<-d/Ntstar;q
 [1] 0.02500000 0.05141388 0.06611570 0.04819277 0.06369427 0.10416667 0.07228916 0.07048458
 [9] 0.03809524 0.02985075
> p<-1-q;p 
 [1] 0.9750000 0.9485861 0.9338843 0.9518072 0.9363057 0.8958333 0.9277108 0.9295154 0.9619048
[10] 0.9701493
> survp<-cumprod(p)
> survp 
 [1] 0.9750000 0.9248715 0.8637229 0.8220977 0.7697348 0.6895541 0.6397068 0.5946174 0.5719653
[10] 0.5548917
> data.frame(Nt,round(p,3),round(survp,3))
    Nt round.p..3. round.survp..3.
1  200       0.975           0.975
2  195       0.949           0.925
3  184       0.934           0.864
4  167       0.952           0.822
5  157       0.936           0.770
6  147       0.896           0.690
7  126       0.928           0.640
8  114       0.930           0.595
9  105       0.962           0.572
10 101       0.970           0.555